# ì˜ì–´ìŠ¤í„°ë”” ì‹œì¦Œ 4 3ì£¼ì°¨

created by [seungho](https://github.com/devaspirant0510) on 2021-10-03

# ğŸ“— ë‹¨ì–´ ì •ë¦¬ ğŸ“˜
|ì˜ì–´|í•œê¸€|
|--|--|
|imposes|ë¶€ê³¼í•˜ë‹¤|
|restrictions|ì œí•œ|
|explicit|ëª…ë°±í•œ|
|immediately|ì¦‰ì‹œ|
|unless|~ì œì™¸í•˜ë©´|

### starting a service

__You can start a service from an activity or other application component
by passing an Intent to startService() or startForegroundService().__  
`ë„ˆëŠ” ì‹œì‘í• ìˆ˜ ìˆë‹¤ ì„œë¹„ìŠ¤ë¥¼ ì•¡í‹°ë¹„í‹° ë˜ëŠ” ë‹¤ë¥¸ 4ëŒ€ ì»´í¬ë„ŒíŠ¸ì—ì„œ intent ë¥¼ startService() ë˜ëŠ” startForegroundService()
ì „ë‹¬í•˜ë©´ ë©ë‹ˆë‹¤.`  

__The Android system calls the service's onStartCommand() method and
passes it the Intent, which specifies which service to start.__   
`ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œì´ ì„œë¹„ìŠ¤ì˜ onStartCommand() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³  ì—¬ê¸°ì— ì‹œì‘í•  ì„œë¹„ìŠ¤ë¥¼ ì§€ì •í•˜ëŠ” ì¸í„´íŠ¸ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.`

> __Note: If your app targets API level 26 or higher, the system imposes 
> restrictions on using or creating background services unless the app 
> itself is in the foreground.__   
> `ì°¸ê³ : ë§Œì•½ ë„ˆì˜ API ë ˆë²¨ì´ 26 ë˜ëŠ” ê·¸ ì´ìƒì¼ë•Œ ë„ˆì˜ ì•±ì´ í¬ê·¸ë¼ìš´ë“œì—ì„œ ëŒì§€ ì•Šìœ¼ë©´ 
> ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ìƒì„±í•˜ëŠ”ê²ƒì— ì‹œìŠ¤í…œì—ì„œ ì œí•œ ë¶€ê³¼í•©ë‹ˆë‹¤.  `  
> __If an app needs to create a foreground service,
> the app should call startForegroundService().__   
> `ë§Œì•½ ë„ˆì˜ ì•±ì— forground servie ë¥¼ ìƒì„±í•˜ëŠ”ê²Œ í•„ìš”í•˜ë‹¤ë©´ startForegroundService() ë¥¼ í˜¸ì¶œí•´ë¼`  
> __That method creates a background service, but the method signals to the system that the 
> service will promote itself to the foreground.__   
> ` ì´ ë©”ì„œë“œëŠ” ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•˜ì§€ë§Œ ê·¸ ë©”ì„œë“œëŠ” ì‹œìŠ¤í…œì—ê²Œ ì„œë¹„ìŠ¤ê°€ ìì²´ì ìœ¼ë¡œ í¬ê·¸ë¼ìš´ë“œë¡œ ìŠ¹ê²©ë ê²ƒì´ë¼ê³  ì•Œë¦½ë‹ˆë‹¤.`  
> __Once the service has been created, the service must call its startForeground() 
> method within five seconds.__  
> `í•œë²ˆ ì„œë¹„ìŠ¤ê°€ ìƒì„±ë˜ë©´ 5ì´ˆì´ë‚´ì— startForeground()ë¥¼ í˜¸ì¶œí•´ì•¼í•©ë‹ˆë‹¤.`  

__For example, an activity can start the example service in the previous section 
(HelloService) using an explicit intent with startService(), as shown here:__  
`ì˜ˆë¥¼ ë“¤ì–´ ì•¡í‹°ë¹„í‹°ëŠ” ì‹œì‘í•˜ë©´ ì´ì „ ì„¹ì…˜ì—ì„œ (HelloService)ë¡œ ëª…ì‹œì  ì¸í…íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. `

```kotlin
Intent(this, HelloService::class.java).also { intent ->
    startService(intent)
}
```

__The startService() method returns immediately, and the Android system calls the service's 
onStartCommand() method. If the service isn't already running, 
the system first calls onCreate(), and then it calls onStartCommand().__  
`startService() ë©”ì„œë“œëŠ” ì¦‰ì‹œ ë°˜í™˜ë˜ê³  ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œì€ ì„œë¹„ìŠ¤ì˜ onStartCommand()ë¥¼ í˜¸ì¶œí•œë‹¤.
ë§Œì•½ ì„œë¹„ìŠ¤ê°€ ë™ì‘í•  ì¤€ë¹„ê°€ ë˜ì§€ì•Šì•˜ë‹¤ë©´ ì‹œìŠ¤í…œì€ ë¨¼ì € onCreate()ë¥¼ í˜¸ì¶œí•˜ê³  ê·¸ë¦¬ê³  ë‚˜ì„œ onStartCommand()ë¥¼ í˜¸ì¶œí•œë‹¤.`

__If the service doesn't also provide binding, the intent that is delivered with startService() 
is the only mode of communication between the application component and the service.__  
`ë§Œì•½ ì„œë¹„ìŠ¤ê°€ bindingì„ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ onStartServiceì™€ í•¨ê»˜ ì „ë‹¬ëœ 4ëŒ€ ì»´í¬ë„ŒíŠ¸ì™€ ì„œë¹„ìŠ¤ê°€ ì„œë¡œ í†µì‹ í•˜ê¸° ìœ„í•œ ìœ ì¼í•œ ë°©ë²•ì…ë‹ˆë‹¤.`

__However, if you want the service to send a result back, the client that starts the service can create a PendingIntent 
for a broadcast (with getBroadcast()) and deliver it to the service in the Intent that starts the service. 
The service can then use the broadcast to deliver a result.__  
`ê·¸ëŸ¬ë‚˜ ë§Œì•½ ë„ˆê°€ ì„œë¹„ìŠ¤ê°€ ì „ì†¡ë˜ëŠ”ê²ƒì„ ê²°ê³¼ë¡œ ë°›ê¸¸ ì›í•œë‹¤ë©´ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•œ í´ë¼ì´ì–¸íŠ¸ê°€ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ìœ„í•´ pendingIntent ë¥¼ ë§Œë“¤ê³ 
ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•œ Intent ì˜ ì„œë¹„ìŠ¤ì— ì „ë‹¬í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

__Multiple requests to start the service result in multiple corresponding calls to the service's onStartCommand().__  
`ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ê¸°ìœ„í•œ ë‹¤ìˆ˜ì˜ ìš”ì²­ì€ ì„œë¹„ìŠ¤ì˜ onStartCommand() ê°€ ë‹¤ìˆ˜ í˜¸ì¶œë˜ì–´ ëŒ€ì‘ë©ë‹ˆë‹¤.`

However, only one request to stop the service (with stopSelf() or stopService()) is required to stop it.  
`ê·¸ëŸ¬ë‚˜, ì„œë¹„ìŠ¤ë¥¼ ì¤‘ë‹¨í•˜ë ¤ë©´ ë‹¨ì§€ í•˜ë‚˜ì˜ ìš”ì²­ìœ¼ë¡œ ì¤‘ë‹¨í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

### Stopping a Service
A started service must manage its own lifecycle.   
`ì‹œì‘ëœ ì„œë¹„ìŠ¤ëŠ” ë§Œë“œì‹œ ìƒëª…ì£¼ê¸°ë¥¼ ì§ì ‘ ê´€ë¦¬í•´ì•¼í•©ë‹ˆë‹¤.`

That is, the system doesn't stop or destroy the service unless it must recover system memory and the service   
continues to run after onStartCommand() returns. 
`ì‹œìŠ¤í…œì—ì„œ ì„œë¹„ìŠ¤ëŠ” stop ë˜ëŠ” destroy í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤, ë‹¤ë§Œ ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ë¥¼ ë³µêµ¬í•˜ê³  ì„œë¹„ìŠ¤ê°€ ê³„ì†ì‹¤í–‰ë˜ì•¼í•˜ëŠ”ê²½ìš° onStartCommand() ë°˜í™˜í›„ì—ë„
ì´ëŠ” ì˜ˆì™¸ì…ë‹ˆë‹¤.`

The service must stop itself by calling stopSelf(), or another component can stop it by calling stopService().  
`ì„œë¹„ìŠ¤ëŠ” ë°˜ë“œì‹œ stopSelf()ë¥¼ í˜¸ì¶œí•˜ì—¬ ìê¸°ìì‹ ì„ ë©ˆì¶”ê±°ë‚˜ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ stopService() ë¥¼ í˜¸ì¶œí•˜ì—¬ ë©ˆì¶œìˆ˜ ìˆìŠµë‹ˆë‹¤.`

Once requested to stop with stopSelf() or stopService(), the system destroys the service as soon as possible.  
`í•œë²ˆ  stopSelf() ë˜ëŠ” stopService() ìš”ì²­ìœ¼ë¡œ ì¤‘ë‹¨ìš”ì²­ì„ ë³´ë‚¸ë©´ , ì‹œìŠ¤í…œì€ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì„œë¹„ìŠ¤ë¥¼ íŒŒê´´ë©ë‹ˆë‹¤. `

If your service handles multiple requests to onStartCommand() concurrently, you shouldn't stop the service
when you're done processing a start request, as you might have received a new start request (stopping at the end
of the first request would terminate the second one).   
`ë§Œì•½ ë„ˆì˜ ì„œë¹„ìŠ¤ê°€ ë‹¤ìˆ˜ì˜ onStartCommand()ì—ëŒ€í•œ ìš”ì²­ì„ ë™ì‹œì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ë©´, ì‹œì‘ ìš”ì²­ì˜ ì²˜ë¦¬ë¥¼ ëë‚¸ë’¤ì—ì„œ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ë‹¨í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.
ê¸° ì´í›„ ìƒˆ ìš”ì²­ì„ ë°›ì„ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤ (ì²« ìš”ì²­ì´ ëë‚ ë•Œ ì¤‘ë‹¨í•˜ë©´ ë‘ë²ˆì§¸ ìš”ì²­ì´ ì¢…ë£Œë ìˆ˜ ìˆìŠµë‹ˆë‹¤.)`

To avoid this problem, you can use stopSelf(int) to ensure that your request to stop the service is always
based on the most recent start request.   
`ì´ ë¬¸ì œë¥¼ ë§‰ìœ¼ë ¤ë©´ stopSelf(int) ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ìš”ì²­ì´ í•­ìƒ ìµœê·¼ ì‹œì‘ìš”ì²­ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤.`

That is, when you call stopSelf(int), you pass the ID of the start request (the startId delivered to onStartCommand()) 
to which your stop request corresponds.   
`ë‹¤ì‹œë§í•´ stopSelf(int)ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš° ì‹œì‘ìš”ì²­ì˜ ID (onStartCommand()ì— ì „ë‹¬ëœ startId) ë¥¼ ì „ë‹¬í•˜ì—¬ ì—¬ê¸°ì— ì¤‘ë‹¨ìš”ì²­ì´ ëŒ€ì‘ë©ë‹ˆë‹¤.`

Then, if the service receives a new start request before you are able to call stopSelf(int), the ID doesn't match 
and the service doesn't stop.  
`ê·¸ëŸ°ë‹¤ìŒ stopSelf(int) ë¥¼ í˜¸ì¶œí• ìˆ˜ ìˆê²Œ ë˜ê¸°ì „ì— ì„œë¹„ìŠ¤ê°€ ìƒˆ ì‹œì‘ ìš”ì²­ì„ ìˆ˜ì‹ í•˜ë©´ ID ê°€ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì„œë¹„ìŠ¤ëŠ” ì¤‘ë‹¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`

