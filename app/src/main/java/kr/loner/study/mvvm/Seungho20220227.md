# ì˜ì–´ìŠ¤í„°ë”” ì‹œì¦Œ 5 5ì£¼ì°¨

created by [seungho](https://github.com/devaspirant0510) on 2022-02-27

[document link](https://medium.com/android-news/lets-keep-activity-dumb-using-livedata-53468ed0dc1f)

# ğŸ“— ë‹¨ì–´ ì •ë¦¬ ğŸ“˜

|ì˜ì–´|í•œê¸€|
|----|----|
|face|ì§ë©´í•˜ë‹¤|
|agnostic|ë¶ˆê°€ì§€ë¡ ì |
|outlive|..ë³´ë‹¤ ì˜¤ë˜ì‚´ë‹¤|

# LiveData Clean Code using MVVM and Android Architecture Components

__This article will talk about things related to every android developer heart :
handling lifecycle events, making code cleaner.__   
`ì´ ê¸€ì—ì„œëŠ” ëª¨ë“  ê°œë°œì ë§ˆìŒê³¼ ê´€ë ¨ëœ ë¼ì´í”„ì‚¬ì´í´ ì²˜ë¦¬,í´ë¦°ì½”ë“œ ë§Œë“¤ê¸°ë¥¼ ì´ì•¼ê¸° í• ê²ƒì´ë‹¤.`

__Remember those days where activity used to hundred or thousand of lines, you most probably have faced this
challenges.__  
`ì•¡í‹°ë¹„í‹°ì—ì„œ ìˆ˜ë°± ìˆ˜ì²œì¤„ì´ ì‚¬ìš©ë˜ëŠ” ë‚ ì„ ê¸°ì–µí•´ë¼, ë„ˆëŠ” ë°˜ë“œì‹œ ì´ë¬¸ì œì— ì§ë©´í–ˆì„ê²ƒì´ë‹¤. `

__Perhaps this would be no surprise weâ€™ve all looked at the mess and felt the relief of our messy activity work.__  
`ì•„ë§ˆ ê·¸ê²ƒì€ ë†€ë„ê²ƒì´ ì•„ë‹ˆë‹¤. ìš°ë¦¬ê°€ ì—‰ë§ì§„ì°½ì„ ë°”ë¼ë³´ì•˜ê³  ì§€ì €ë¶„í•œ ì•¡í‹°ë¹„í‹° ì‘ì—…ì—ì„œ ì•ˆë„ê°ì„ ëŠë¼ëŠ”ê²ƒì´`

__For those familiar with Uncle Bob, Clean Architecture is no stranger.__  
`Uncle Bobì— ìµìˆœí•œì‚¬ëŒì€ í´ë¦°ì•„í‚¤í…ì³ëŠ” ë‚¯ì„¤ì§€ ì•Šë‹¤.`

__Itâ€™s a set of architectural guidelines based on SOLID principles.__  
`ê·¸ê²ƒì€ SOLID ì›ì¹™ ê¸°ë°˜ì˜ ì•„í‚¤í…ì³ ê°€ì´ë“œë¼ì¸ì´ë‹¤.`

__This principles helps to achieve: testability, separation of concerns, modularity, among some other good practices.__  
`ì´ ì›ì¹™ì€ í…ŒìŠ¤íŠ¸ê°€ëŠ¥í•˜ê³ , ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ê³ ,ëª¨ë“ˆí™”í•˜ê³  ê¸°íƒ€ ëª¨ë²”ì‚¬ë¡€ë¥¼ ë‹¬ì„±í•˜ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.`

__In our simple priority order, developer wants there business as well as UI logic should be unit tested.__  
`ìš°ë¦¬ëŠ” ê°„ë‹¨í•œ ìš°ì„ ìˆœìœ„ì—ì„œ, ê°œë°œìëŠ” ê·¸ë“¤ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§ê³¼ UI ë¡œì§ì´ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì³ê°€ëŠ”ê²ƒì„ ì›í•©ë‹ˆë‹¤. `

### Views arenâ€™t easy to test, as it contains android related frameworks.

__Views should be dumb and implement Passive View pattern.__  
`view ëŠ” ë©ì²­í•´ì•¼í•˜ê³  Passice View íŒ¨í„´ì„ êµ¬í˜„í•´ì•¼í•©ë‹ˆë‹¤.`

__Passive View pattern is a concept that UI logic should be minimum.__  
`íŒ¨ì‹œë¸Œ ë·° íŒ¨í„´ì€ UI logic ì´ ìµœì†Œí™”ë˜ì•¼ë˜ëŠ” ì»¨ì…‰ì´ë‹¤.`

__Coming to Single responsibility principle view have responsibility of rendering.__  
`ë‹¨ì¼ì±…ì„ì›ì¹™ì„ ë³´ë©´ ê¸°ë³¸ì ì¸ ë·°ëŠ” ë Œë”ë§ì—ëŒ€í•œ ì±…ì„ì„ ê°–ê³ ìˆìŠµë‹ˆë‹¤.`

__It should display the view state currently the user is.__  
`ê·¸ê²ƒì€ í˜„ì¬ ìœ ì €ì˜ ë·°ìƒíƒœ ë¥¼ ë³´ì—¬ì¤˜ì•¼ë©ë‹ˆë‹¤`

__For example: If we are implementing login screen, you should not write validation logic inside UI, it should be
responsibility of the presentation layer.__  
`ì˜ˆ :  ë§Œì•½ ìš°ë¦¬ê°€ ë¡œê·¸ì¸í™”ë©´ì„ êµ¬í˜„í•œë‹¤ë©´, ë„ˆëŠ” UI ì—ì„œ ê²€ì¦ ë¡œì§ì„ ì‘ì„±í•˜ë©´ ì•ˆë©ë‹ˆë‹¤. ì´ê²ƒì€ presentation layer ì—ì„œ ë‹´ë‹¹í•´ì•¼í•©ë‹ˆë‹¤.`

__As View has context its a gateway for android related frameworks too.We should try not to put conditional logic inside
our view, as views does not support unit testing.__  
`ë·°ì—ëŠ” Android ê´€ë ¨ ê²Œì´íŠ¸ì›¨ì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ìš°ë¦¬ì˜ ë·°ì— ì¡°ê±´ë¶€ ë¡œì§ì„ ë„£ìœ¼ë ¤ëŠ”ê±¸ ì‹œë„í•˜ì§€ í•œë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤. ë·°ëŠ” ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ì§€ ì•Šê¸°ë•Œë¬¸ì—`

__We can test UI using Roboelectric , Instrumentation testing or Espresso.__  
`ìš°ë¦¬ëŠ” Robelectric,Instrumentation í…ŒìŠ¤íŠ¸ ë˜ëŠ” espresso ë¥¼ ì‚¬ìš©í•˜ì—¬ UI í…ŒìŠ¤íŠ¸ë¥¼ í• ìˆ˜ìˆìŠµë‹ˆë‹¤. `

__The Presentation layer should be responsible of having business logic (like input validation), communication to data
layer and provide data for UI rendering.__  
`Presentation ë ˆì´ì–´ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§(ì…ë ¥ ê²€ì¦ê³¼ ê°™ì€)ì„ ì±…ì„ì ¸ì•¼í•˜ê³ , ë°ì´í„°ë ˆì´ì–´ì™€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜í•˜ê³  UI rendering ì„ ìœ„í•œ ë°ì´í„°ë¥¼ ì œê³µí•´ì•¼í•©ë‹ˆë‹¤.`

__Presentation layer (ViewModel or Presenter) does not use android framework it should be agnostic, so you can encapsulate
all logic and that makes it testable. We can use JVM unit testing here.__  
`Presentation ë ˆì´ì–´(mvvvm ì˜ ë·°ëª¨ë¸ ë˜ëŠ” mvp ì˜ Presenter) ì•ˆë“œë¡œì´ë“œ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì§€ì•Šìœ¼ë©° ë¶ˆê°€ì§€ë¡ ì ì´ì—¬ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ëª¨ë“  ë¡œì§ì„ ìº¡ìŠí™” í•˜ê³  í…ŒìŠ¤íŠ¸ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” JVM ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì—¬ê¸°ì„œ ì‚¬ìš©í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

__It should not have any direct dependency of view.__  
`ê·¸ê²ƒì€ ì§ì ‘ì ìœ¼ë¡œ ë·°ì—ëŒ€í•œ ì§ì ‘ì ì¸ì˜ì¡´ì„ ê°€ì ¸ì„œëŠ” ì•ˆë©ë‹ˆë‹¤.`

__In this article Iâ€™m following MVVM architectural pattern.__  
`ì´ ê¸°ì‚¬ì—ì„œ ë‚˜ëŠ” MVVM ì•„í‚¤í…ì³ íŒ¨í„´ì„ ë”°ë¥´ê³  ìˆìŠµë‹ˆë‹¤.`
__The main pillars of this pattern are :__  
`ì´ íŒ¨í„´ì˜ ì£¼ìš” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.`

- The View â€” that informs the ViewModel about the userâ€™s actions  
  `view - ì‚¬ìš©ì ì•¡ì…˜ì—ëŒ€í•´ ë·°ëª¨ë¸ì— ì•Œë¦½ë‹ˆë‹¤.`
- The ViewModel- presentation layer, having UI logic and taking to data model.  
  `ë·°ëª¨ë¸ - presentaion ë ˆì´ì–´, UI ë¡œì§ì„ ê°€ì§€ê³  data model ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.`
- The DataModel â€” abstracts the data source. It can have both remote and local data. The ViewModel works with the
  DataModel to get and save the data.  
  `DataModel - ì¶”ìƒí™” ë°ì´í„° ì†ŒìŠ¤, ê·¸ê²ƒì€ Remote ì™€ ë¡œì»¬ë°ì´í„° ë‘˜ë‹¤ ê°€ì§ˆìˆ˜ ìˆìŠµë‹ˆë‹¤. ë·°ëª¨ë¸ì€ DataModel ê³¼ í•¨ê»˜ ì‘ë™í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì €ì¥í•©ë‹ˆë‹¤.  `

### View Model should not have any reference of view.

__We have issue like what should be scope of view model on configuration change, will it die if activity dies.__  
`ìš°ë¦¬ëŠ” ì´ìŠˆë¥¼ ê°€ì§€ê³ ìˆìŠµë‹ˆë‹¤. êµ¬ì„±ë³€ê²½ì—ëŒ€í•œ ë·°ëª¨ë¸ì˜ ë²”ìœ„ê°€ ì–´ë–»ê²Œ ë˜ì–´ì•¼í•˜ëŠ”ì§€ ë§Œì•½ ì•¡í‹°ë¹„í‹°ê°€ ì£½ìœ¼ë©´ ê·¸ê²ƒ(ë·°ëª¨ë¸)ì€ ì£½ì„ê²ƒì¸ì§€ `

__Suppose we have long running operations in background and if configurations changes and viewmodel has reference to view
it might lead to memory leaks and null pointer exceptions.__  
`ìš°ë¦¬ëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì˜¤ë˜ë™ì•ˆ ì—°ì‚°ë˜ê³  ë§Œì•½ êµ¬ì„±ìš”ì†Œê°€ ë°”ë€Œê³  ë·°ëª¨ë¸ì€ view ì—ëŒ€í•œ ì°¸ì¡°ë¥¼ ê°€ì§€ê³ ìˆë‹¤ë©´ ë©”ëª¨ë¦¬ëˆ„ìˆ˜ ë° ë„í¬ì¸í„° ìµì…‰ì…˜ì„ ê°€ì§ˆìˆ˜ìˆë‹¤ê³  ê°€ì •í•œë‹¤.`

__Recently during Google I/O, Google introduced Livedata and ViewModel as part of architecture components.__  
`ìµœê·¼ì— êµ¬ê¸€ IOì—ì„œ êµ¬ê¸€ì€ ì•„í‚¤í…ì³ ì»´í¬ë„ŒíŠ¸ ì¼ë¶€ë¥¼ ë¼ì´ë¸Œë°ì´í„°ì™€ ë·°ëª¨ë¸ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤.`

__Android Architecture Components is a new collection of libraries to help developers manage lifecycle issues, write
modular code and provide great user experience.__  
`Android ì•„í‚¤í…ì³ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒëª…ì£¼ê¸° ì´ìŠˆ,ëª¨ë“ˆëŸ¬ ì½”ë“œ ì‘ì„±ê³¼ ì¢‹ì€ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•˜ëŠ” ê°œë°œìë¥¼ ë„ì™€ì¤„ ë¼ì´ë¸ŒëŸ¬ë¥´ ëª¨ìŒì…ë‹ˆë‹¤.  `

__We can take advantage of lifecycle components. Our view activity or fragment have a lifecycle owner.__  
`ìš°ë¦¬ëŠ” lifecycle component ë¥¼ í™œìš©í• ìˆ˜ ìˆìŠµë‹ˆë‹¤., ìš°ë¦¬ì˜ ë·° ì•¡í‹°ë¹„í‹° ë˜ëŠ” í”„ë ˆê·¸ë¨¼íŠ¸ëŠ” lifecycle owner ë¥¼ ê°€ì§‘ë‹ˆë‹¤.`

__Using this lifecycle components we can make our presentation layer aware of this.__  
`lifecycle ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ëŠ” ìš°ë¦¬ìœ¼ ê·¸ê²ƒ(lifecycler)ì„ ì•Œê³ ìˆëŠ” Presentation ë ˆì´ì–´ë¥¼ ë§Œë“¤ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

__Our ViewModel can now outlive configuration changes (such as rotation) and survive as it is persisted.__  
`ìš°ë¦¬ì˜ ë·°ëª¨ë¸ì€ ì´ì œ êµ¬ì„±ë³€ê²½(í™”ë©´íšŒì „ê³¼ ê°™ì´) ë³´ë‹¤ ì˜¤ë˜ì§€ì†ë˜ê³  ìœ ì§€ë ìˆ˜ ìˆìŠµë‹ˆë‹¤. `

__If view is resuming after configuration change it would get back the previous ViewModel, this can help to achieve view
state consistency.__  
`êµ¬ì„± ë³€ê²½ í›„ ë·°ê°€ ë‹¤ì‹œ ì‹œì‘ë˜ë©´ ì´ì „ ViewModelë¡œ ëŒì•„ê°€ë¯€ë¡œ ë·° ìƒíƒœ ì¼ê´€ì„±ì„ ë‹¬ì„±í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

__There is also AndroidViewModel which comes with context, but be aware of it using as it cannot be unit tested and
polluting with android frameworks.__  
`ì»¨í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ ì œê³µë˜ëŠ” AndroidViewModelë„ ìˆì§€ë§Œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•˜ê³  Android í”„ë ˆì„ì›Œí¬ë¡œ ì˜¤ì—¼ë˜ë¯€ë¡œ ì‚¬ìš©ì— ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.`

__Itâ€™s somewhat defeat the purpose of separation of concern.__  
`ìš°ë ¤ì˜ ë¶„ë¦¬ ëª©ì ì„ ë‹¤ì†Œ ë¬´ì‚°ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤.`

